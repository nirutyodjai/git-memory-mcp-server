# =============================================================================
# Enterprise Security System Configuration
# =============================================================================
# Copy this file to .env.security and update the values for your environment
# IMPORTANT: Change all default passwords and secrets in production!

# =============================================================================
# Basic Configuration
# =============================================================================
NODE_ENV=development
SECURITY_PORT=3333
SECURITY_HOST=localhost
SECURITY_BASE_URL=http://localhost:3333

# =============================================================================
# JWT Configuration
# =============================================================================
# CRITICAL: Change these secrets in production!
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_ALGORITHM=HS256
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d
JWT_ISSUER=git-memory-mcp-server
JWT_AUDIENCE=git-memory-users

# =============================================================================
# API Key Configuration
# =============================================================================
API_KEY_LENGTH=32
API_KEY_EXPIRES_IN=30d
API_KEY_PREFIX=gmcp_
API_KEY_RATE_LIMIT=1000

# =============================================================================
# Encryption & Hashing
# =============================================================================
BCRYPT_ROUNDS=12
SESSION_SECRET=your-session-secret-change-in-production-min-32-chars
CSRF_SECRET=your-csrf-secret-change-in-production-min-32-chars
ENCRYPTION_KEY=your-encryption-key-change-in-production-32-chars
HASH_SALT=your-hash-salt-change-in-production-16-chars

# =============================================================================
# Database Configuration
# =============================================================================
# MongoDB Configuration
DB_TYPE=mongodb
DB_HOST=localhost
DB_PORT=27017
DB_NAME=security_db
DB_USER=security_user
DB_PASS=security_password_change_in_production
DB_AUTH_SOURCE=admin
DB_SSL=false
DB_REPLICA_SET=
DB_MAX_POOL_SIZE=10
DB_MIN_POOL_SIZE=2

# Alternative: PostgreSQL Configuration
# DB_TYPE=postgresql
# DB_HOST=localhost
# DB_PORT=5432
# DB_NAME=security_db
# DB_USER=security_user
# DB_PASS=security_password_change_in_production
# DB_SSL=false
# DB_MAX_CONNECTIONS=20

# Alternative: MySQL Configuration
# DB_TYPE=mysql
# DB_HOST=localhost
# DB_PORT=3306
# DB_NAME=security_db
# DB_USER=security_user
# DB_PASS=security_password_change_in_production
# DB_SSL=false
# DB_CONNECTION_LIMIT=10

# =============================================================================
# Redis Configuration (Optional - for session management and caching)
# =============================================================================
REDIS_ENABLED=true
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=redis_password_change_in_production
REDIS_DB=0
REDIS_KEY_PREFIX=gmcp:security:
REDIS_TTL=3600
REDIS_MAX_RETRIES=3

# =============================================================================
# Rate Limiting Configuration
# =============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false
RATE_LIMIT_SKIP_FAILED_REQUESTS=false

# Login Rate Limiting
LOGIN_RATE_LIMIT_WINDOW_MS=900000
LOGIN_RATE_LIMIT_MAX_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=1800000

# API Rate Limiting
API_RATE_LIMIT_WINDOW_MS=3600000
API_RATE_LIMIT_MAX_REQUESTS=1000

# =============================================================================
# Security Headers & CORS Configuration
# =============================================================================
# CORS Configuration
CORS_ENABLED=true
CORS_ORIGIN=http://localhost:3000,http://localhost:3333
CORS_METHODS=GET,HEAD,PUT,PATCH,POST,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-API-Key,X-Tenant-ID
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Security Headers
HELMET_ENABLED=true
CSP_ENABLED=true
CSP_DIRECTIVES=default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'

# CSRF Protection
CSRF_ENABLED=true
CSRF_COOKIE_NAME=_csrf
CSRF_HEADER_NAME=X-CSRF-Token

# =============================================================================
# Monitoring & Logging Configuration
# =============================================================================
# Monitoring
MONITORING_ENABLED=true
MONITORING_INTERVAL=30000
MONITORING_RETENTION_DAYS=30
MONITORING_ALERT_THRESHOLD=0.8

# Health Check
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=60000
HEALTH_CHECK_TIMEOUT=5000

# Performance Monitoring
PERF_MONITORING_ENABLED=true
PERF_MONITORING_SAMPLE_RATE=0.1
PERF_MONITORING_SLOW_QUERY_THRESHOLD=1000

# =============================================================================
# Audit Logging Configuration
# =============================================================================
AUDIT_ENABLED=true
AUDIT_LOG_LEVEL=info
AUDIT_LOG_FORMAT=json
AUDIT_LOG_FILE=logs/audit.log
AUDIT_LOG_MAX_SIZE=10m
AUDIT_LOG_MAX_FILES=10
AUDIT_RETENTION_DAYS=90
AUDIT_ENCRYPTION_ENABLED=true
AUDIT_INTEGRITY_CHECK=true

# Application Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=logs/application.log
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5

# =============================================================================
# Email Configuration (for notifications and alerts)
# =============================================================================
EMAIL_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
EMAIL_FROM=noreply@your-domain.com
EMAIL_FROM_NAME=Git Memory Security System

# =============================================================================
# Notification Configuration
# =============================================================================
# Slack Notifications
SLACK_ENABLED=false
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#security-alerts
SLACK_USERNAME=Security Bot

# Discord Notifications
DISCORD_ENABLED=false
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/DISCORD/WEBHOOK

# Microsoft Teams Notifications
TEAMS_ENABLED=false
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/TEAMS/WEBHOOK

# =============================================================================
# Multi-Factor Authentication (MFA)
# =============================================================================
MFA_ENABLED=true
MFA_REQUIRED_FOR_ADMIN=true
MFA_ISSUER=Git Memory MCP Server
MFA_WINDOW=1
MFA_BACKUP_CODES_COUNT=10

# TOTP Configuration
TOTP_ENABLED=true
TOTP_PERIOD=30
TOTP_DIGITS=6
TOTP_ALGORITHM=sha1

# SMS Configuration (for SMS-based MFA)
SMS_ENABLED=false
SMS_PROVIDER=twilio
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_PHONE_NUMBER=+1234567890

# =============================================================================
# OAuth 2.0 Configuration
# =============================================================================
OAUTH_ENABLED=false

# Google OAuth
GOOGLE_OAUTH_ENABLED=false
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
GOOGLE_CALLBACK_URL=http://localhost:3333/auth/google/callback

# GitHub OAuth
GITHUB_OAUTH_ENABLED=false
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
GITHUB_CALLBACK_URL=http://localhost:3333/auth/github/callback

# Microsoft OAuth
MICROSOFT_OAUTH_ENABLED=false
MICROSOFT_CLIENT_ID=your-microsoft-client-id
MICROSOFT_CLIENT_SECRET=your-microsoft-client-secret
MICROSOFT_CALLBACK_URL=http://localhost:3333/auth/microsoft/callback

# =============================================================================
# LDAP/Active Directory Configuration
# =============================================================================
LDAP_ENABLED=false
LDAP_URL=ldap://localhost:389
LDAP_BIND_DN=cn=admin,dc=example,dc=com
LDAP_BIND_CREDENTIALS=admin_password
LDAP_SEARCH_BASE=dc=example,dc=com
LDAP_SEARCH_FILTER=(uid={{username}})
LDAP_GROUP_SEARCH_BASE=ou=groups,dc=example,dc=com
LDAP_GROUP_SEARCH_FILTER=(member={{dn}})

# =============================================================================
# Backup & Recovery Configuration
# =============================================================================
BACKUP_ENABLED=true
BACKUP_INTERVAL=86400000
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=./backups
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_COMPRESSION_ENABLED=true

# =============================================================================
# Feature Flags
# =============================================================================
FEATURE_DASHBOARD_ENABLED=true
FEATURE_API_ENABLED=true
FEATURE_WEBSOCKET_ENABLED=true
FEATURE_REAL_TIME_MONITORING=true
FEATURE_THREAT_DETECTION=true
FEATURE_COMPLIANCE_REPORTING=true
FEATURE_SECURITY_SCANNING=true
FEATURE_PENETRATION_TESTING=false

# =============================================================================
# Development & Testing Configuration
# =============================================================================
# Development Mode Settings
DEV_MODE=true
DEV_MOCK_EXTERNAL_SERVICES=true
DEV_SKIP_EMAIL_VERIFICATION=true
DEV_ALLOW_WEAK_PASSWORDS=false

# Testing Configuration
TEST_MODE=false
TEST_DATABASE_URL=mongodb://localhost:27017/security_test_db
TEST_REDIS_URL=redis://localhost:6379/1
TEST_SKIP_RATE_LIMITING=true
TEST_MOCK_NOTIFICATIONS=true

# =============================================================================
# Performance Configuration
# =============================================================================
# Caching
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=1000
CACHE_CHECK_PERIOD=600

# Connection Pooling
CONNECTION_POOL_MIN=2
CONNECTION_POOL_MAX=10
CONNECTION_POOL_IDLE_TIMEOUT=30000
CONNECTION_POOL_ACQUIRE_TIMEOUT=60000

# Request Timeout
REQUEST_TIMEOUT=30000
API_TIMEOUT=10000
DB_TIMEOUT=5000

# =============================================================================
# Compliance Configuration
# =============================================================================
# GDPR Compliance
GDPR_ENABLED=true
GDPR_DATA_RETENTION_DAYS=365
GDPR_ANONYMIZATION_ENABLED=true
GDPR_RIGHT_TO_BE_FORGOTTEN=true

# SOX Compliance
SOX_ENABLED=false
SOX_AUDIT_TRAIL_REQUIRED=true
SOX_SEGREGATION_OF_DUTIES=true

# HIPAA Compliance
HIPAA_ENABLED=false
HIPAA_ENCRYPTION_REQUIRED=true
HIPAA_ACCESS_LOGGING_REQUIRED=true

# PCI DSS Compliance
PCI_DSS_ENABLED=false
PCI_DSS_ENCRYPTION_REQUIRED=true
PCI_DSS_ACCESS_CONTROL_REQUIRED=true

# =============================================================================
# Custom Configuration
# =============================================================================
# Add your custom configuration variables here
# CUSTOM_FEATURE_ENABLED=true
# CUSTOM_API_ENDPOINT=https://api.example.com
# CUSTOM_SECRET_KEY=your-custom-secret

# =============================================================================
# Environment-Specific Overrides
# =============================================================================
# These will be loaded based on NODE_ENV
# development.env, production.env, test.env files can override these values